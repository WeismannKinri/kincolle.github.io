<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java Parallel Program Basic Knowledge (1) | Asahina Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/ok_favicon.ico">
    <meta name="description" content="For Tech Blog">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.167a03c8.css" as="style"><link rel="preload" href="/assets/js/app.7bf124e2.js" as="script"><link rel="preload" href="/assets/js/3.11415aa8.js" as="script"><link rel="preload" href="/assets/js/1.f9d84a83.js" as="script"><link rel="preload" href="/assets/js/87.7df4d88d.js" as="script"><link rel="prefetch" href="/assets/js/10.160e6e9c.js"><link rel="prefetch" href="/assets/js/100.3cdef464.js"><link rel="prefetch" href="/assets/js/101.5178591b.js"><link rel="prefetch" href="/assets/js/102.336b2e64.js"><link rel="prefetch" href="/assets/js/103.b749e8f0.js"><link rel="prefetch" href="/assets/js/104.4e0be82d.js"><link rel="prefetch" href="/assets/js/105.2283e32d.js"><link rel="prefetch" href="/assets/js/106.f6d10c35.js"><link rel="prefetch" href="/assets/js/107.168e6177.js"><link rel="prefetch" href="/assets/js/108.8668c986.js"><link rel="prefetch" href="/assets/js/109.6971a03e.js"><link rel="prefetch" href="/assets/js/11.286216e9.js"><link rel="prefetch" href="/assets/js/110.eae35184.js"><link rel="prefetch" href="/assets/js/111.05a11607.js"><link rel="prefetch" href="/assets/js/112.3e67db1b.js"><link rel="prefetch" href="/assets/js/113.89cb826b.js"><link rel="prefetch" href="/assets/js/114.f3d7a768.js"><link rel="prefetch" href="/assets/js/115.63beb6b3.js"><link rel="prefetch" href="/assets/js/116.d3f81a36.js"><link rel="prefetch" href="/assets/js/117.b85ad082.js"><link rel="prefetch" href="/assets/js/118.f1a51aea.js"><link rel="prefetch" href="/assets/js/119.19e0a7b9.js"><link rel="prefetch" href="/assets/js/12.e7c5cbfb.js"><link rel="prefetch" href="/assets/js/120.86fd078a.js"><link rel="prefetch" href="/assets/js/121.007d2594.js"><link rel="prefetch" href="/assets/js/122.f22031f8.js"><link rel="prefetch" href="/assets/js/123.84ca6b69.js"><link rel="prefetch" href="/assets/js/124.3fbddabe.js"><link rel="prefetch" href="/assets/js/125.db4ff77b.js"><link rel="prefetch" href="/assets/js/126.10227c11.js"><link rel="prefetch" href="/assets/js/127.0d7b5084.js"><link rel="prefetch" href="/assets/js/128.1acf472b.js"><link rel="prefetch" href="/assets/js/129.825fe808.js"><link rel="prefetch" href="/assets/js/13.43cc31b1.js"><link rel="prefetch" href="/assets/js/130.0bfc98b2.js"><link rel="prefetch" href="/assets/js/131.aede149c.js"><link rel="prefetch" href="/assets/js/132.85593e8b.js"><link rel="prefetch" href="/assets/js/133.0f271fc3.js"><link rel="prefetch" href="/assets/js/14.0dd24f84.js"><link rel="prefetch" href="/assets/js/15.1b41732d.js"><link rel="prefetch" href="/assets/js/16.183ffc75.js"><link rel="prefetch" href="/assets/js/17.ad9af643.js"><link rel="prefetch" href="/assets/js/18.c13df2c1.js"><link rel="prefetch" href="/assets/js/19.2203e54d.js"><link rel="prefetch" href="/assets/js/20.34db0668.js"><link rel="prefetch" href="/assets/js/21.44a33107.js"><link rel="prefetch" href="/assets/js/22.52d283c5.js"><link rel="prefetch" href="/assets/js/23.4e0524b7.js"><link rel="prefetch" href="/assets/js/24.decf705e.js"><link rel="prefetch" href="/assets/js/25.6873ed81.js"><link rel="prefetch" href="/assets/js/26.4d86aa15.js"><link rel="prefetch" href="/assets/js/27.6b45c11e.js"><link rel="prefetch" href="/assets/js/28.f4d58a14.js"><link rel="prefetch" href="/assets/js/29.871a72fd.js"><link rel="prefetch" href="/assets/js/30.49b4c5ea.js"><link rel="prefetch" href="/assets/js/31.cfc2945d.js"><link rel="prefetch" href="/assets/js/32.343850cd.js"><link rel="prefetch" href="/assets/js/33.0517526c.js"><link rel="prefetch" href="/assets/js/34.85ea8eb4.js"><link rel="prefetch" href="/assets/js/35.43969a65.js"><link rel="prefetch" href="/assets/js/36.7836aa64.js"><link rel="prefetch" href="/assets/js/37.e5812400.js"><link rel="prefetch" href="/assets/js/38.d8d214a6.js"><link rel="prefetch" href="/assets/js/39.f1cb3672.js"><link rel="prefetch" href="/assets/js/4.64515438.js"><link rel="prefetch" href="/assets/js/40.7adf5ab8.js"><link rel="prefetch" href="/assets/js/41.57755578.js"><link rel="prefetch" href="/assets/js/42.38ebc979.js"><link rel="prefetch" href="/assets/js/43.ca6a6476.js"><link rel="prefetch" href="/assets/js/44.41942e77.js"><link rel="prefetch" href="/assets/js/45.41cc929c.js"><link rel="prefetch" href="/assets/js/46.4cbb486f.js"><link rel="prefetch" href="/assets/js/47.ee2cc207.js"><link rel="prefetch" href="/assets/js/48.4397b1ca.js"><link rel="prefetch" href="/assets/js/49.d9aa00a5.js"><link rel="prefetch" href="/assets/js/5.a9ee7173.js"><link rel="prefetch" href="/assets/js/50.b45ed76a.js"><link rel="prefetch" href="/assets/js/51.919d0154.js"><link rel="prefetch" href="/assets/js/52.eb85632f.js"><link rel="prefetch" href="/assets/js/53.3a47197f.js"><link rel="prefetch" href="/assets/js/54.c8d2aed8.js"><link rel="prefetch" href="/assets/js/55.b8b65327.js"><link rel="prefetch" href="/assets/js/56.2d8e9a6e.js"><link rel="prefetch" href="/assets/js/57.38ba175c.js"><link rel="prefetch" href="/assets/js/58.2f7ff696.js"><link rel="prefetch" href="/assets/js/59.56eb125d.js"><link rel="prefetch" href="/assets/js/6.3a661d6d.js"><link rel="prefetch" href="/assets/js/60.197980b0.js"><link rel="prefetch" href="/assets/js/61.4b544728.js"><link rel="prefetch" href="/assets/js/62.b2382e0f.js"><link rel="prefetch" href="/assets/js/63.733bd9cd.js"><link rel="prefetch" href="/assets/js/64.d59be5ac.js"><link rel="prefetch" href="/assets/js/65.9db92d49.js"><link rel="prefetch" href="/assets/js/66.b89a7790.js"><link rel="prefetch" href="/assets/js/67.1353b5b4.js"><link rel="prefetch" href="/assets/js/68.6cf3768b.js"><link rel="prefetch" href="/assets/js/69.5590fae6.js"><link rel="prefetch" href="/assets/js/7.9cb840c5.js"><link rel="prefetch" href="/assets/js/70.2ded2061.js"><link rel="prefetch" href="/assets/js/71.5a572a0a.js"><link rel="prefetch" href="/assets/js/72.4894d369.js"><link rel="prefetch" href="/assets/js/73.c3a7815f.js"><link rel="prefetch" href="/assets/js/74.d1adf6f2.js"><link rel="prefetch" href="/assets/js/75.7e41458b.js"><link rel="prefetch" href="/assets/js/76.686c4022.js"><link rel="prefetch" href="/assets/js/77.835ea7c3.js"><link rel="prefetch" href="/assets/js/78.9ffc54ca.js"><link rel="prefetch" href="/assets/js/79.b6aa2776.js"><link rel="prefetch" href="/assets/js/8.a1c97708.js"><link rel="prefetch" href="/assets/js/80.97d7ee23.js"><link rel="prefetch" href="/assets/js/81.a0a3a3ee.js"><link rel="prefetch" href="/assets/js/82.2290dd53.js"><link rel="prefetch" href="/assets/js/83.0927cd8c.js"><link rel="prefetch" href="/assets/js/84.4d42c930.js"><link rel="prefetch" href="/assets/js/85.f344b6f7.js"><link rel="prefetch" href="/assets/js/86.f7bb8b2b.js"><link rel="prefetch" href="/assets/js/88.2b2debf8.js"><link rel="prefetch" href="/assets/js/89.042c73d8.js"><link rel="prefetch" href="/assets/js/9.402194bf.js"><link rel="prefetch" href="/assets/js/90.4d7b430c.js"><link rel="prefetch" href="/assets/js/91.f65d4f6e.js"><link rel="prefetch" href="/assets/js/92.89ac564f.js"><link rel="prefetch" href="/assets/js/93.160f3887.js"><link rel="prefetch" href="/assets/js/94.29ed14c3.js"><link rel="prefetch" href="/assets/js/95.4afaed8c.js"><link rel="prefetch" href="/assets/js/96.e8ef314f.js"><link rel="prefetch" href="/assets/js/97.e8db3b68.js"><link rel="prefetch" href="/assets/js/98.540f1fa5.js"><link rel="prefetch" href="/assets/js/99.3a27d21e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.167a03c8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-130b300a><div data-v-130b300a><div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-130b300a data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>Asahina Blog</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>For Tech Blog</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>Kincolle</span>
            
          <span data-v-25ba6db2>2020 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-130b300a><header class="navbar" data-v-130b300a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="Asahina Blog" class="logo"> <span class="site-name">Asahina Blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Algorithm/" class="nav-link"><i class="undefined"></i>
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/categories/Design Pattern/" class="nav-link"><i class="undefined"></i>
  Design Pattern
</a></li><li class="dropdown-item"><!----> <a href="/categories/Elasticsearch/" class="nav-link"><i class="undefined"></i>
  Elasticsearch
</a></li><li class="dropdown-item"><!----> <a href="/categories/Hive/" class="nav-link"><i class="undefined"></i>
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/Lucene/" class="nav-link"><i class="undefined"></i>
  Lucene
</a></li><li class="dropdown-item"><!----> <a href="/categories/Mybatis/" class="nav-link"><i class="undefined"></i>
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/categories/Redis/" class="nav-link"><i class="undefined"></i>
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/categories/Spring/" class="nav-link"><i class="undefined"></i>
  Spring
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="https://github.com/kincolle" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  My Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-130b300a></div> <aside class="sidebar" data-v-130b300a><div class="personal-info-wrapper" data-v-39576ba9 data-v-130b300a><img src="/avatar.jpg" alt="author-avatar" class="personal-img" data-v-39576ba9> <h3 class="name" data-v-39576ba9>
    Kincolle
  </h3> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>123</h3> <h6 data-v-39576ba9>Articles</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>13</h3> <h6 data-v-39576ba9>Tags</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Algorithm/" class="nav-link"><i class="undefined"></i>
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/categories/Design Pattern/" class="nav-link"><i class="undefined"></i>
  Design Pattern
</a></li><li class="dropdown-item"><!----> <a href="/categories/Elasticsearch/" class="nav-link"><i class="undefined"></i>
  Elasticsearch
</a></li><li class="dropdown-item"><!----> <a href="/categories/Hive/" class="nav-link"><i class="undefined"></i>
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/Lucene/" class="nav-link"><i class="undefined"></i>
  Lucene
</a></li><li class="dropdown-item"><!----> <a href="/categories/Mybatis/" class="nav-link"><i class="undefined"></i>
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/categories/Redis/" class="nav-link"><i class="undefined"></i>
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/categories/Spring/" class="nav-link"><i class="undefined"></i>
  Spring
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="https://github.com/kincolle" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  My Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>Java Parallel Program Basic Knowledge (1)</h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>Kincolle</span>
            
          <span data-v-25ba6db2>2020 - </span>
          2022
        </a></span></div></div> <div data-v-130b300a><main class="page"><section><div class="page-title"><h1 class="title">Java Parallel Program Basic Knowledge (1)</h1> <div data-v-f875f3fc><i class="iconfont reco-account" data-v-f875f3fc><span data-v-f875f3fc>Kincolle</span></i> <i class="iconfont reco-date" data-v-f875f3fc><span data-v-f875f3fc>3/2/2018</span></i> <!----> <i class="tags iconfont reco-tag" data-v-f875f3fc><span class="tag-item" data-v-f875f3fc>Java Concurrency</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="_1-something-about-thread"><a href="#_1-something-about-thread" class="header-anchor">#</a> 1 Something About Thread</h2> <p>Before I introduce thread, I'd like to introduce its mother process. At earlier time, Process is the fundamental executin unit. At the modern thread design, process is the docker of thread. Different Processed share no main memory but different threads of one process shared main memory.<br>
The following picture will show yout the life time of thread.</p> <p>Status of thread is defined in the enum</p> <div class="language- extra-class"><pre><code>public enum State{
	NEW,
	RUNNABLE,
	BLOCKED,
	WAITING,
	TIMED_WAITING,
	TERMINATED;
}
</code></pre></div><p>NEW status means created thread which still not run even one time. Until stat() is invoked, thread starts. If a thread meets synchronized block when running, then this thread will go into BLOCKED status and stop running until get the lock to unlock. Both WAITING and TIMED_WAITING means waiting status. The difference is that WAITING means wait in no limited time and TIMED_WAITING means wait in limited time. You may wonder what threads wait for. Generally speaking, WAITING threads wait for some special event like notify(). When threads finish execution, its status will be TERMINATED.</p> <blockquote><p>From NEW status starting means never get back to NEW and is the same to RUNNABLE.</p></blockquote> <h1 id="_2-thread-basic-using"><a href="#_2-thread-basic-using" class="header-anchor">#</a> 2 Thread Basic Using</h1> <p>To learn to use concurrency, you need to learn its API first. In this section I will show you about it.</p> <h2 id="_2-1-create-thread"><a href="#_2-1-create-thread" class="header-anchor">#</a> 2.1 Create Thread</h2> <p>It's east to create one thread. Just use 'new' to create one thread and use start() to run it.</p> <div class="language- extra-class"><pre><code>Thread thread1 = new Thread();
thread1.start();
</code></pre></div><p>What it will do affer start() is the point. In Thread class, there is a run() function and start() will create one new thread and do the run().<br>
Here is an attention: the following code can be compiled and runned, but it just does run() of the current thread and not create one new thread.</p> <div class="language- extra-class"><pre><code>Thread thread1 = new Thread();
thread1.run();
</code></pre></div><p>So, there is a big difference between start() and run().<br>
In the default situation, run() of Thread class does nothing. So, we need to Override the run() function.<br></p> <div class="language- extra-class"><pre><code>Thread thread1 = new Thread(){
	@Override
	public static run(){
		system.out.println(&quot;Hello, this is thread1&quot;);
	}
};
thread1.start();
</code></pre></div><p>The codes above use an anonymous class and overaride run() which us &quot;system.out.println(&quot;Hello, this is thread1&quot;);&quot;. As we know in java there is only a single &quot;extend&quot;, which means is a rare resources. So, we can use an interface called &quot;Runnable&quot; to do it. In Runnable, there is only one function &quot;run()&quot;.</p> <div class="language- extra-class"><pre><code>public interface Runnable{
	public abstract void run();
}
</code></pre></div><p>Besides, in Thread class there is a important construction function.</p> <div class="language- extra-class"><pre><code>public Thread(Runnable target);
</code></pre></div><p>It will pass a Runnable instance and when start() is invoked the new thread will do Runnable.run(). In the source code is like the following</p> <div class="language- extra-class"><pre><code>public Thread(Runnable target) {
    init(null, target, &quot;Thread-&quot; + nextThreadNum(), 0);
}
</code></pre></div><p>The following will show you one case of uee Runnable</p> <div class="language- extra-class"><pre><code>public class NewThreadUsingRannable implements Runnable{
	public static void main(String[] args) {
        Thread t1 = new Thread(new NewThreadUsingRannable());
        t1.start();	
  	}
	@Override
	public void run(){
		System.out.println(&quot;This is using Runnable interface&quot;);
	}
}
</code></pre></div><h2 id="_2-2-stop-thread"><a href="#_2-2-stop-thread" class="header-anchor">#</a> 2.2 Stop Thread</h2> <p>You can use stop() to stop one thread. But in multi-thread situation I sugeest not to use it. The reason is since it will stop one thread immediately, concurrency may happen. For example, there are 2 datas:</p> <blockquote><p>data1: Id=1, Name=tokyo;<br>
data2: Id=2, Name=kyoto;</p></blockquote> <p>If will write data1 to the database and it stop when finished with Id but not with Name. That means we get only half of data1 in the database. Then write data2 into database, the result may be:</p> <blockquote><p>data1: Id=1, Name=kyoto;<br>
data2: Id=2, Name=null;</p></blockquote> <p>The following picture will show you why</p> <h2 id="_2-3-interrupt-thread"><a href="#_2-3-interrupt-thread" class="header-anchor">#</a> 2.3 Interrupt Thread</h2> <p>As I said in 2.3, stop() function has some problems, so there is another function called interrupt. Interrupt will notice a thread that &quot;You show quit&quot;. What the will the thread do depends on the thread it self. About  interrupt, there are 3  functions</p> <div class="language- extra-class"><pre><code>public void Thread.interrupt()  // interrupt a thread
public boolean Thread.isInterrupted()  // judge whether a thread is interrupted
public static boolean Thread.interrupted()  // judge whether a thread is interrupted and clear  all interrupt status
</code></pre></div><p>Thread.interrupt() is a function of a instance which will interrupt one thread (means set interrupted flag). Thread.isInterrupted() is a function of a instance too and it will judge whether the thread is interrupted. So, what will the following codes do?</p> <div class="language- extra-class"><pre><code>public static void main(String[] args) throws InterruptedException {
    Thread thread1 = new Thread(){
        @Override
        public void run(){
            while (true){
                Thread.yield();
            }
        }
    };
    thread1.start();
    Thread.sleep(2000);
    thread1.interrupt();
}
</code></pre></div><p>Here, apparently thread1 is interrupted but there is no logic codes in interruption of thread1. So, thread1 is interrupted and will do nothing.<br>
If you hope thread1 will quit when interrupt, the do like the following code.</p> <div class="language- extra-class"><pre><code>public static void main(String[] args) throws InterruptedException {
    Thread thread1 = new Thread(){
        @Override
        public void run(){
            while (true){
                if(Thread.currentThread().isInterrupted()){
                    System.out.println(&quot;it is interrupted&quot;);
                    break;
                }
                Thread.yield();
            }
        }
    };
    thread1.start();
    Thread.sleep(2000);
    thread1.interrupt();
}
</code></pre></div><h2 id="_2-5-wait-and-notify"><a href="#_2-5-wait-and-notify" class="header-anchor">#</a> 2.5 wait and notify</h2> <p>For cooperation of threads, JDK provides 2 important interface wait() and notify(). These 2 functions are not in Thread class but in Obeject class. That means any object cab use them.<br>
The signature is like the following:</p> <div class="language- extra-class"><pre><code>public final void wait() throws InterrruptedException
public final native void notify()
</code></pre></div><p>When a instance invokes wait(), the current thread will wait on this instance. What does that means? For example, thread A invokes obj.wait(), then thread A will stop operating and tuen status into WAIT. So, when will this end? Until another thread invokes obj.wait(). So, this obj instance is a way to communicate between threads.<br>
So, how does wait() and notify() work? The following picture will show you this.
<img src="Concurrency-Java-Parallel-Program-Basic-Knowledge/1.png" alt="">
If a thread use object.wait(), then it will go into wait queue of the object instance. In this wait queue, numbers of threads may in it, because numbers of threads are wait for one object. When object.notify() is invoked, it will choose one randomly to notify. Here, the choosing is not fair.<br>
Besides notify(), there is another method named notifyall() in object instance. The difference is that it will nofity all threads.<br>
One point needed to be emphasized is that object.wait() can not be invoked at any time. It must be in synchronized block, no matter wait() or nofity(), it needs a monitor of a object. Here is a example of it:</p> <div class="language- extra-class"><pre><code>public class WaitAndNofity {
    final static Object object = new Object();
    public static class T1 extends Thread{
        public void run(){
            synchronized (object){
                System.out.println(System.currentTimeMillis()+&quot;:T1 start.&quot;);
                try {
                    System.out.println(System.currentTimeMillis()+&quot;T1 wait for object.&quot;);
                    object.wait();
                }catch (InterruptedException e){
                    e.printStackTrace();
                }
                System.out.println(System.currentTimeMillis()+&quot;T1 end.&quot;);
            }
        }
    }
    public static class T2 extends Thread{
        public void run(){
            synchronized (object){
                System.out.println(System.currentTimeMillis() +&quot;T2 start.&quot;);
                object.notify();
                System.out.println(System.currentTimeMillis()+&quot;T2 end.&quot;);
                try {
                    Thread.sleep(2000);
                }catch (InterruptedException e){
                    e.printStackTrace();
                }
            }
        }
    }

    public static void main(String[] args) {
        Thread t1 = new T1();
        Thread t2 = new T2();
        t1.start();
        t2.start();
    }
}
</code></pre></div><p>Then, run the code and the result will be:</p> <div class="language- extra-class"><pre><code>1521272046986:T1 start.
1521272046986T1 wait for object.
1521272046986T2 start.
1521272046986T2 end.
1521272048987T1 end.
</code></pre></div><h2 id="_2-6-join-and-yield"><a href="#_2-6-join-and-yield" class="header-anchor">#</a> 2.6 join and yield</h2> <p>At the most situation, input of one thread may depends on other threads. At this time, you can use join().Here are 2 join functinos:</p> <div class="language- extra-class"><pre><code>public final void join() throws InterruptedException
public final synchronized void join(long millis) throws InterruptedException    
</code></pre></div><p>THe first one means wait forever until the targer thread has finished. The second one provides a waiting time, and if over it then go on. Here is a join() intance:</p> <div class="language- extra-class"><pre><code>public class JoinMain {
    public volatile static int i = 0;
    public static class addThread extends Thread{
        @Override
        public void run() {
            for(i=0;i&lt;10000000;i++);
        }
    }

    public static void main(String[] args) throws InterruptedException {
        addThread addThread = new addThread();
        addThread.start();
        addThread.join();
        System.out.println(i);
    }
}
</code></pre></div><p>In the main function, if there is no join(), the i may less than 10000000. Since there is a join(), so the &quot;System.out.println(i);&quot; must wait for the addThread. That is the reason the outcome will be 10000000.<br>
About join, I want to say that in fact it invokes wait() on the current object.Here is a part of the source code in JDK:</p> <div class="language- extra-class"><pre><code>while(isAlinve()){
	wait(0)
}
</code></pre></div><p>We can see that it let the invoking thread wait on current object. When the current thread finished, waited thread will invoke nofityall() to notify all waited thread to go on.</p> <h2 id="_2-7-volatile-and-jmm"><a href="#_2-7-volatile-and-jmm" class="header-anchor">#</a> 2.7 volatile and JMM</h2> <p>I have described JMM bebore and all JMM is about atomic thing. volatile is for that. So if you want to know something about vaolatile, just see my article about JMM.</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">4/10/2022, 10:47:25 PM</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/views/JavaConcurrency/Concurrency-Java-Parallel-Program-Basic-Knowledge.html#_1-something-about-thread" class="sidebar-link reco-side-_1-something-about-thread" data-v-cb1513f6>1 Something About Thread</a></li><li class="level-2" data-v-cb1513f6><a href="/views/JavaConcurrency/Concurrency-Java-Parallel-Program-Basic-Knowledge.html#_2-1-create-thread" class="sidebar-link reco-side-_2-1-create-thread" data-v-cb1513f6>2.1 Create Thread</a></li><li class="level-2" data-v-cb1513f6><a href="/views/JavaConcurrency/Concurrency-Java-Parallel-Program-Basic-Knowledge.html#_2-2-stop-thread" class="sidebar-link reco-side-_2-2-stop-thread" data-v-cb1513f6>2.2 Stop Thread</a></li><li class="level-2" data-v-cb1513f6><a href="/views/JavaConcurrency/Concurrency-Java-Parallel-Program-Basic-Knowledge.html#_2-3-interrupt-thread" class="sidebar-link reco-side-_2-3-interrupt-thread" data-v-cb1513f6>2.3 Interrupt Thread</a></li><li class="level-2" data-v-cb1513f6><a href="/views/JavaConcurrency/Concurrency-Java-Parallel-Program-Basic-Knowledge.html#_2-5-wait-and-notify" class="sidebar-link reco-side-_2-5-wait-and-notify" data-v-cb1513f6>2.5 wait and notify</a></li><li class="level-2" data-v-cb1513f6><a href="/views/JavaConcurrency/Concurrency-Java-Parallel-Program-Basic-Knowledge.html#_2-6-join-and-yield" class="sidebar-link reco-side-_2-6-join-and-yield" data-v-cb1513f6>2.6 join and yield</a></li><li class="level-2" data-v-cb1513f6><a href="/views/JavaConcurrency/Concurrency-Java-Parallel-Program-Basic-Knowledge.html#_2-7-volatile-and-jmm" class="sidebar-link reco-side-_2-7-volatile-and-jmm" data-v-cb1513f6>2.7 volatile and JMM</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎来到 Asahina Blog
    </div> <div class="operation" style="right:90px;bottom:40px;display:none;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:none;" data-v-5775ee02></i></div> <canvas id="banniang" width="200" height="320" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/bgm/紅蓮華.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/bgm/紅蓮華.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/bgm/紅蓮華.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>紅蓮華</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>Lisa</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><canvas id="vuepress-canvas-cursor"></canvas><div></div><div id="goTop" class="hide-cat" data-v-bf92849a></div></div></div>
    <script src="/assets/js/app.7bf124e2.js" defer></script><script src="/assets/js/3.11415aa8.js" defer></script><script src="/assets/js/1.f9d84a83.js" defer></script><script src="/assets/js/87.7df4d88d.js" defer></script>
  </body>
</html>
